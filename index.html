<!DOCTYPE html>
<html lang="ko">
  <head>
    <link rel="stylesheet" href="static/style.css" />
    <meta charset="UTF-8" />
    <title>상품 분류 추천 시스템 데모</title>
    <script>
      async function getRecommendations() {
        const query = document.getElementById("query").value;

        // // 로컬에서 FastAPI 서버를 실행하는 경우
        // const response = await fetch(
        //   `https://210.223.36.71:8000/recommend?query=${encodeURIComponent(
        //     query
        //   )}`
        // );

        const response = await fetch(
          `https://0c51-210-223-36-71.ngrok-free.app/recommend?query=${encodeURIComponent(
            query
          )}`
        );

        // // Vercel 서버리스 함수로 요청 보내기
        // const response = await fetch(
        //   `https://item-category-classification-demo.vercel.app/api/recommend?query=${encodeURIComponent(
        //     query
        //   )}`
        // );

        const data = await response.json();

        console.log("Received data:", data); // 콘솔에 응답 데이터를 출력

        const resultDiv = document.getElementById("results");
        resultDiv.innerHTML = "";

        if (data.recommendations.length > 0) {
          resultDiv.innerHTML += "<h3>추천 결과:</h3>";
          data.recommendations.forEach((item) => {
            resultDiv.innerHTML += `<p>라벨: ${item.label}, 확률: ${(
              item.probability * 100
            ).toFixed(2)}%</p>`;
          });
        } else {
          resultDiv.innerHTML = "<p>결과가 없습니다.</p>";
        }
      }

      // Enter 키를 눌렀을 때 getRecommendations 호출
      window.onload = () => {
        const input = document.getElementById("query");
        input.addEventListener("keydown", (event) => {
          if (event.key === "Enter") {
            event.preventDefault(); // 폼 제출 방지
            getRecommendations(); // 추천 함수 호출
          }
        });
      };
    </script>
  </head>
  <body>
    <div class="container">
      <h1>상품 분류 추천 시스템 데모</h1>
      <label for="query">상품명을 입력하세요:</label>
      <input type="text" id="query" name="query" />
      <button onclick="getRecommendations()">추천 받기</button>

      <div id="results"></div>
    </div>
  </body>
</html>
